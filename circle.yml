machine:
  services:
      - docker

dependencies:
  override:
      - docker build -t aneris/aneris:latest .

test:
  override:
      # there is some extra rigamaroll in order to get the .coverage file back onto the host machine
      - docker run -v $PWD:/aneris/transfer aneris/aneris:latest /bin/bash -c "python2 -m pytest /aneris/tests --cov=aneris && cp .coverage /aneris/transfer" 
      - docker run aneris/aneris:latest python3 -m pytest /aneris/tests --cov=aneris --cov-report term-missing --runslow
  post:
      - coveralls